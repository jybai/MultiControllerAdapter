function [x_next, y_next] = dynamics(x, y, d)
   x0 = x;
   x1 = y;
   if (x0 <= 0) && (x1 <= 0)
       u = 0.000928948617280185*x0^5*x1^5 - 0.00916399869757268*x0^5*x1^4*(0.5*x1 + 1.0) + 0.0359492755565422*x0^5*x1^3*(0.5*x1 + 1.0)^2 - 0.0697812831650494*x0^5*x1^2*(0.5*x1 + 1.0)^3 + 0.0663546609086653*x0^5*x1*(0.5*x1 + 1.0)^4 - 0.0242989823616826*x0^5*(0.5*x1 + 1.0)^5 - 0.00901303508196066*x0^4*x1^5*(0.5*x0 + 1.0) + 0.0888179680344847*x0^4*x1^4*(0.5*x0 + 1.0)*(0.5*x1 + 1.0) - 0.345683835873506*x0^4*x1^3*(0.5*x0 + 1.0)*(0.5*x1 + 1.0)^2 + 0.662967804739889*x0^4*x1^2*(0.5*x0 + 1.0)*(0.5*x1 + 1.0)^3 - 0.620875261092142*x0^4*x1*(0.5*x0 + 1.0)*(0.5*x1 + 1.0)^4 + 0.219175156206897*x0^4*(0.5*x0 + 1.0)*(0.5*x1 + 1.0)^5 + 0.0342929325034368*x0^3*x1^5*(0.5*x0 + 1.0)^2 - 0.335026834570705*x0^3*x1^4*(0.5*x0 + 1.0)^2*(0.5*x1 + 1.0) + 1.29510688414621*x0^3*x1^3*(0.5*x0 + 1.0)^2*(0.5*x1 + 1.0)^2 - 2.45425797734338*x0^3*x1^2*(0.5*x0 + 1.0)^2*(0.5*x1 + 1.0)^3 + 2.23577864969541*x0^3*x1*(0.5*x0 + 1.0)^2*(0.5*x1 + 1.0)^4 - 0.747138020536159*x0^3*(0.5*x0 + 1.0)^2*(0.5*x1 + 1.0)^5 - 0.0649982352275076*x0^2*x1^5*(0.5*x0 + 1.0)^3 + 0.608680173858395*x0^2*x1^4*(0.5*x0 + 1.0)^3*(0.5*x1 + 1.0) - 2.3099942479049*x0^2*x1^3*(0.5*x0 + 1.0)^3*(0.5*x1 + 1.0)^2 + 4.2916198431204*x0^2*x1^2*(0.5*x0 + 1.0)^3*(0.5*x1 + 1.0)^3 - 3.78526479374207*x0^2*x1*(0.5*x0 + 1.0)^3*(0.5*x1 + 1.0)^4 + 1.13980752730271*x0^2*(0.5*x0 + 1.0)^3*(0.5*x1 + 1.0)^5 + 0.0606156325401482*x0*x1^5*(0.5*x0 + 1.0)^4 - 0.547379326256262*x0*x1^4*(0.5*x0 + 1.0)^4*(0.5*x1 + 1.0) + 1.91962458065328*x0*x1^3*(0.5*x0 + 1.0)^4*(0.5*x1 + 1.0)^2 - 3.40266427514137*x0*x1^2*(0.5*x0 + 1.0)^4*(0.5*x1 + 1.0)^3 + 2.81495386449012*x0*x1*(0.5*x0 + 1.0)^4*(0.5*x1 + 1.0)^4 - 0.623037268729621*x0*(0.5*x0 + 1.0)^4*(0.5*x1 + 1.0)^5 - 0.0219364595755122*x1^5*(0.5*x0 + 1.0)^5 + 0.185778797077615*x1^4*(0.5*x0 + 1.0)^5*(0.5*x1 + 1.0) - 0.580437016636*x1^3*(0.5*x0 + 1.0)^5*(0.5*x1 + 1.0)^2 + 0.787827976122108*x1^2*(0.5*x0 + 1.0)^5*(0.5*x1 + 1.0)^3 - 0.402989675793996*x1*(0.5*x0 + 1.0)^5*(0.5*x1 + 1.0)^4 - 0.0577596421143753*(0.5*x0 + 1.0)^5*(0.5*x1 + 1.0)^5;
   elseif (x0 > 0) && (x1 <= 0)
       u = 0.000150032123969873*x0^5*x1^5 - 0.00308339119439689*x0^5*x1^4*(0.5*x1 + 1.0) + 0.0164295623165587*x0^5*x1^3*(0.5*x1 + 1.0)^2 - 0.0382896529619009*x0^5*x1^2*(0.5*x1 + 1.0)^3 + 0.0430193573968502*x0^5*x1*(0.5*x1 + 1.0)^4 - 0.0198514695158768*x0^5*(0.5*x1 + 1.0)^5 - 0.000253879367538489*x0^4*x1^5*(1 - 0.5*x0) - 0.0145394309352573*x0^4*x1^4*(1 - 0.5*x0)*(0.5*x1 + 1.0) + 0.128504707298381*x0^4*x1^3*(1 - 0.5*x0)*(0.5*x1 + 1.0)^2 - 0.327604701436284*x0^4*x1^2*(1 - 0.5*x0)*(0.5*x1 + 1.0)^3 + 0.381645250111604*x0^4*x1*(1 - 0.5*x0)*(0.5*x1 + 1.0)^4 - 0.180368510809315*x0^4*(1 - 0.5*x0)*(0.5*x1 + 1.0)^5 - 0.00763621744643007*x0^3*x1^5*(1 - 0.5*x0)^2 + 0.0086057362017819*x0^3*x1^4*(1 - 0.5*x0)^2*(0.5*x1 + 1.0) + 0.238691159214774*x0^3*x1^3*(1 - 0.5*x0)^2*(0.5*x1 + 1.0)^2 - 1.02972383540377*x0^3*x1^2*(1 - 0.5*x0)^2*(0.5*x1 + 1.0)^3 + 1.29748247447734*x0^3*x1*(1 - 0.5*x0)^2*(0.5*x1 + 1.0)^4 - 0.658779058746641*x0^3*(1 - 0.5*x0)^2*(0.5*x1 + 1.0)^5 - 0.0287775695337441*x0^2*x1^5*(1 - 0.5*x0)^3 + 0.150032624704958*x0^2*x1^4*(1 - 0.5*x0)^3*(0.5*x1 + 1.0) - 0.0564482137952344*x0^2*x1^3*(1 - 0.5*x0)^3*(0.5*x1 + 1.0)^2 - 1.08230617762456*x0^2*x1^2*(1 - 0.5*x0)^3*(0.5*x1 + 1.0)^3 + 2.06485615092688*x0^2*x1*(1 - 0.5*x0)^3*(0.5*x1 + 1.0)^4 - 1.14545087677975*x0^2*(1 - 0.5*x0)^3*(0.5*x1 + 1.0)^5 - 0.0443319446475492*x0*x1^5*(1 - 0.5*x0)^4 + 0.332444885751689*x0*x1^4*(1 - 0.5*x0)^4*(0.5*x1 + 1.0) - 0.785933550928012*x0*x1^3*(1 - 0.5*x0)^4*(0.5*x1 + 1.0)^2 + 0.344005620138051*x0*x1^2*(1 - 0.5*x0)^4*(0.5*x1 + 1.0)^3 + 1.08511143886861*x0*x1*(1 - 0.5*x0)^4*(0.5*x1 + 1.0)^4 - 0.748258780456722*x0*(1 - 0.5*x0)^4*(0.5*x1 + 1.0)^5 - 0.0219364595755122*x1^5*(1 - 0.5*x0)^5 + 0.185778797077615*x1^4*(1 - 0.5*x0)^5*(0.5*x1 + 1.0) - 0.580437016636*x1^3*(1 - 0.5*x0)^5*(0.5*x1 + 1.0)^2 + 0.787827976122108*x1^2*(1 - 0.5*x0)^5*(0.5*x1 + 1.0)^3 - 0.402989675793996*x1*(1 - 0.5*x0)^5*(0.5*x1 + 1.0)^4 - 0.0577596421143753*(1 - 0.5*x0)^5*(0.5*x1 + 1.0)^5;
   elseif (x0 <= 0) && (x1 > 0)
       u = -1.68237185631749e-5*x0^5*x1^5 - 0.00137265691589281*x0^5*x1^4*(1 - 0.5*x1) - 0.0128738605645146*x0^5*x1^3*(1 - 0.5*x1)^2 - 0.0400875482389648*x0^5*x1^2*(1 - 0.5*x1)^3 - 0.0522590867847153*x0^5*x1*(1 - 0.5*x1)^4 - 0.0242989823616826*x0^5*(1 - 0.5*x1)^5 - 0.000857136995611502*x0^4*x1^5*(0.5*x0 + 1.0) + 0.00365050759497323*x0^4*x1^4*(1 - 0.5*x1)*(0.5*x0 + 1.0) + 0.0636022984063337*x0^4*x1^3*(1 - 0.5*x1)^2*(0.5*x0 + 1.0) + 0.287262593040093*x0^4*x1^2*(1 - 0.5*x1)^3*(0.5*x0 + 1.0) + 0.433276773681636*x0^4*x1*(1 - 0.5*x1)^4*(0.5*x0 + 1.0) + 0.219175156206897*x0^4*(1 - 0.5*x1)^5*(0.5*x0 + 1.0) + 0.00793058201122367*x0^3*x1^5*(0.5*x0 + 1.0)^2 + 0.025894239272097*x0^3*x1^4*(1 - 0.5*x1)*(0.5*x0 + 1.0)^2 - 0.0898508510375479*x0^3*x1^3*(1 - 0.5*x1)^2*(0.5*x0 + 1.0)^2 - 0.642500488572981*x0^3*x1^2*(1 - 0.5*x1)^3*(0.5*x0 + 1.0)^2 - 1.29596615986417*x0^3*x1*(1 - 0.5*x1)^4*(0.5*x0 + 1.0)^2 - 0.747138020536159*x0^3*(1 - 0.5*x1)^5*(0.5*x0 + 1.0)^2 - 0.0299095841895402*x0^2*x1^5*(0.5*x0 + 1.0)^3 - 0.172563602727978*x0^2*x1^4*(1 - 0.5*x1)*(0.5*x0 + 1.0)^3 - 0.189230153834663*x0^2*x1^3*(1 - 0.5*x1)^2*(0.5*x0 + 1.0)^3 + 0.484882952902779*x0^2*x1^2*(1 - 0.5*x1)^3*(0.5*x0 + 1.0)^3 + 1.59618721155199*x0^2*x1*(1 - 0.5*x1)^4*(0.5*x0 + 1.0)^3 + 1.13980752730271*x0^2*(1 - 0.5*x1)^5*(0.5*x0 + 1.0)^3 + 0.0429022583350872*x0*x1^5*(0.5*x0 + 1.0)^4 + 0.328809661605968*x0*x1^4*(1 - 0.5*x1)*(0.5*x0 + 1.0)^4 + 0.827482377803221*x0*x1^3*(1 - 0.5*x1)^2*(0.5*x0 + 1.0)^4 + 0.712366052873993*x0*x1^2*(1 - 0.5*x1)^3*(0.5*x0 + 1.0)^4 - 0.184462714809*x0*x1*(1 - 0.5*x1)^4*(0.5*x0 + 1.0)^4 - 0.623037268729621*x0*(1 - 0.5*x1)^5*(0.5*x0 + 1.0)^4 - 0.0198729702610131*x1^5*(0.5*x0 + 1.0)^5 - 0.172419485487368*x1^4*(1 - 0.5*x1)*(0.5*x0 + 1.0)^5 - 0.552964576638355*x1^3*(1 - 0.5*x1)^2*(0.5*x0 + 1.0)^5 - 0.828644185698245*x1^2*(1 - 0.5*x1)^3*(0.5*x0 + 1.0)^5 - 0.523394158704696*x1*(1 - 0.5*x1)^4*(0.5*x0 + 1.0)^5 - 0.0577596421143753*(1 - 0.5*x1)^5*(0.5*x0 + 1.0)^5;	 
   elseif (x0 > 0) && (x1 > 0)	   
	   u = -0.000861963318768725*x0^5*x1^5 - 0.00838880289222062*x0^5*x1^4*(1 - 0.5*x1) - 0.0326167222357075*x0^5*x1^3*(1 - 0.5*x1)^2 - 0.0613296039754442*x0^5*x1^2*(1 - 0.5*x1)^3 - 0.0559160626338112*x0^5*x1*(1 - 0.5*x1)^4 - 0.0198514695158768*x0^5*(1 - 0.5*x1)^5 - 0.00826681573687151*x0^4*x1^5*(1 - 0.5*x0) - 0.079969372754532*x0^4*x1^4*(1 - 0.5*x0)*(1 - 0.5*x1) - 0.306623718288423*x0^4*x1^3*(1 - 0.5*x0)*(1 - 0.5*x1)^2 - 0.584296310949316*x0^4*x1^2*(1 - 0.5*x0)*(1 - 0.5*x1)^3 - 0.528574914984719*x0^4*x1*(1 - 0.5*x0)*(1 - 0.5*x1)^4 - 0.180368510809315*x0^4*(1 - 0.5*x0)*(1 - 0.5*x1)^5 - 0.0313188237034999*x0^3*x1^5*(1 - 0.5*x0)^2 - 0.29905126993831*x0^3*x1^4*(1 - 0.5*x0)^2*(1 - 0.5*x1) - 1.12719547163565*x0^3*x1^3*(1 - 0.5*x0)^2*(1 - 0.5*x1)^2 - 2.10559425537224*x0^3*x1^2*(1 - 0.5*x0)^2*(1 - 0.5*x1)^3 - 1.95080932166931*x0^3*x1*(1 - 0.5*x0)^2*(1 - 0.5*x1)^4 - 0.658779058746641*x0^3*(1 - 0.5*x0)^2*(1 - 0.5*x1)^5 - 0.0592617106736781*x0^2*x1^5*(1 - 0.5*x0)^3 - 0.551113489069787*x0^2*x1^4*(1 - 0.5*x0)^3*(1 - 0.5*x1) - 2.02194466139783*x0^2*x1^3*(1 - 0.5*x0)^3*(1 - 0.5*x1)^2 - 3.64300900409365*x0^2*x1^2*(1 - 0.5*x0)^3*(1 - 0.5*x1)^3 - 3.28587372300366*x0^2*x1*(1 - 0.5*x0)^3*(1 - 0.5*x1)^4 - 1.14545087677975*x0^2*(1 - 0.5*x0)^3*(1 - 0.5*x1)^5 - 0.0547272187272542*x0*x1^5*(1 - 0.5*x0)^4 - 0.497797167055983*x0*x1^4*(1 - 0.5*x0)^4*(1 - 0.5*x1) - 1.76798959760862*x0*x1^3*(1 - 0.5*x0)^4*(1 - 0.5*x1)^2 - 3.04205965160895*x0*x1^2*(1 - 0.5*x0)^4*(1 - 0.5*x1)^3 - 2.49800606849821*x0*x1*(1 - 0.5*x0)^4*(1 - 0.5*x1)^4 - 0.748258780456722*x0*(1 - 0.5*x0)^4*(1 - 0.5*x1)^5 - 0.0198729702610131*x1^5*(1 - 0.5*x0)^5 - 0.172419485487368*x1^4*(1 - 0.5*x0)^5*(1 - 0.5*x1) - 0.552964576638355*x1^3*(1 - 0.5*x0)^5*(1 - 0.5*x1)^2 - 0.828644185698245*x1^2*(1 - 0.5*x0)^5*(1 - 0.5*x1)^3 - 0.523394158704696*x1*(1 - 0.5*x0)^5*(1 - 0.5*x1)^4 - 0.0577596421143753*(1 - 0.5*x0)^5*(1 - 0.5*x1)^5;
   else
       error('undefined section')
   end    
   action = u * 20;
   if action > 20
       action = 20;
   end
   if action < -20
       action = -20;
   end
   x_next = x + 0.05 * y;
   y_next = y + 0.05 * ((1-x^2)*y - x + action) + d;
end