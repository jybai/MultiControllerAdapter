import matplotlib.patches as mpatches
import matplotlib.pyplot as plt

red_patch = mpatches.Patch(color='#e377c2', label='$X_{I}$')
# blue_patch = mpatches.Patch(color='#1f77b4', label='$X_{I}^{2}$')

import numpy as np

#构造等高线函数
def rl1(x,y):
    return -0.357383768019-0.0977143650762*(x/3)-0.0267949152538*(y/3)+0.662983677257*(x/3)**2-0.361192480951*(x/3)**2*(y/3)+0.410252670351*(y/3)**2+0.141324130177*(y/3)**3+0.349205035506*(x/3)**3-0.871585127725*(x/3)*(y/3)**3+0.384718470545*(x/3)**2*(y/3)**3+2.4959091816*(x/3)**3*(y/3)**3+0.439444426395*(x/3)*(y/3)**2-3.90897619843*(x/3)**2*(y/3)**2-1.56816467439*(x/3)**3*(y/3)**2+0.221712997844*(x/3)*(y/3)-0.316901787701*(x/3)**3*(y/3)+0.533815517192*(x/3)**4+1.43864453527*(y/3)**4-0.388073012871*(x/3)**5+1.05577057015*(x/3)**4*(y/3)-0.623034893834*(x/3)*(y/3)**4-0.110474858834*(y/3)**5-0.246895122972*(x/3)**6-0.466767461534*(x/3)**5*(y/3)+7.0796985825*(x/3)**4*(y/3)**2+4.19562725704*(x/3)**2*(y/3)**4+0.693863980004*(x/3)*(y/3)**5-1.0655262006*(y/3)**6+0.135886379069*(x/3)**7-0.689005901172*(x/3)**6*(y/3)+1.09589765935*(x/3)**5*(y/3)**2-0.720675129093*(x/3)**4*(y/3)**3+1.30156887551*(x/3)**3*(y/3)**4-0.135248531981*(x/3)**2*(y/3)**5+0.264868804654*(x/3)*(y/3)**6-0.00463431140825*(y/3)**7-0.16707732275*(x/3)**8+0.59845931213*(x/3)**7*(y/3)-3.03208198348*(x/3)**6*(y/3)**2-1.24626552468*(x/3)**5*(y/3)**3-8.77296493305*(x/3)**4*(y/3)**4-1.88879419528*(x/3)**3*(y/3)**5-0.634824553648*(x/3)**2*(y/3)**6+0.00199333871765*(x/3)*(y/3)**7-0.000108666568477*(y/3)**8

#作点
x=np.linspace(-2,2,500)
y=np.linspace(-2,2,500)

#构造网格
X,Y=np.meshgrid(x,y)

#绘制等高线,8表示等高线数量加1
plt.figure(figsize=(6, 4))
plt.contourf(X,Y,rl1(X,Y),[-0.014,-0.01], colors='#e377c2')
# plt.contour(X,Y,rl2(X,Y),0,colors='#1f77b4')
# plt.title('Inner-approximation of maximal robust invariant set')
plt.xlabel('$x_{1}$', fontsize=13)
plt.ylabel('$x_{2}$', fontsize=13)
# plt.legend(proxy, ["LQR"])
# # plt.legend()
plt.legend(handles=[red_patch], fontsize=11,loc='lower left')
plt.savefig('OS_Inner.pdf', bbox='tight')